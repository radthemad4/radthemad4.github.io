import{j as s,r as m}from"./client-ibsvyqoG.js";const c={width:"3em"},g={position:"sticky",top:0,backgroundColor:"white",padding:"5px"},y=o=>s.jsxs("div",{children:[s.jsx("input",{style:c,type:"number",min:"1",defaultValue:`${o.levels}`,onChange:o.onChangeLevels})," level(s)/HD with ",s.jsx("input",{title:"The number of ranks a class would 'normally' get if not using skill groups",style:c,type:"number",min:"0",defaultValue:`${o.ranksPerLevel}`,onChange:o.onChangeRanksPerLevel})," ",s.jsx("span",{style:{textDecorationStyle:"dotted",textDecorationLine:"underline"},title:"The number of ranks a class would 'normally' get per level if not using this system",children:"ranks per level"}),o.showMinusButton?s.jsx("button",{onClick:o.onRemoveClass,children:"-"}):""]}),j=o=>s.jsxs("div",{style:{whiteSpace:"nowrap"},children:[o.classes.map((r,e)=>s.jsx(y,{levels:r.levels,ranksPerLevel:r.ranksPerLevel,onChangeLevels:l=>{o.onChangeLevelsAtIndex(e,l)},onChangeRanksPerLevel:l=>{o.onChangeRanksPerLevelAtIndex(e,l)},onRemoveClass:l=>{o.onRemoveClassAtIndex(e,l)},showMinusButton:e!==0},e)),s.jsx("button",{onClick:()=>{o.addClass()},children:"+"}),s.jsxs("div",{children:["Number of Levels: ",o.classes.reduce((r,e)=>r+e.levels,0)]}),s.jsxs("div",{children:["Ranks per group: ",o.classes.reduce((r,e,l)=>r+(e.levels+(l===0?3:0))*e.ranksPerLevel*.5,0)]})]});var x=(o=>(o[o.normal=0]="normal",o[o.bonus=1]="bonus",o[o.intModRanks=2]="intModRanks",o))(x||{});const f=o=>s.jsxs("span",{style:{color:o.used>o.total?"red":o.used===o.total?"green":"black"},children:[o.used,"/",o.total]});class C extends m.Component{constructor(r){super(r),this.state={classes:[{levels:1,ranksPerLevel:2}],intScore:10,skillGroups:[...this.props.skillGroups]}}get ranksPerGroup(){return Math.floor(this.state.classes.reduce((r,e,l)=>r+(e.levels+(l===0?3:0))*e.ranksPerLevel*.5,0))}get numberOfLevels(){return this.state.classes.reduce((r,e)=>r+e.levels,0)}get intMod(){return Math.floor((this.state.intScore-10)*.5)}set intScore(r){this.setState(e=>{let l=[...e.skillGroups];if(e.intScore<12&&r>=12){if(e.skillGroups.length>0&&e.skillGroups[0].type!=2&&e.skillGroups.length>1&&e.skillGroups[1].type!=2){let t={groupName:"IntMod",skills:[{skillName:"Use Magic Device",ranksInGroup:0}],type:2};l[0].type==1?l=[l[0],t,...l.slice(1,l.length)]:l=[t,...l]}}else e.intScore>=12&&r<12&&(l=l.filter(t=>t.type!=2));return{intScore:r,skillGroups:l}})}render(){return s.jsxs("div",{style:{fontSize:"1em"},children:[s.jsx("h1",{style:{fontSize:"1.2em"},children:s.jsx("a",{href:"https://tgdmb.com/viewtopic.php?t=56277",children:"Kaelik Skill Groups"})}),s.jsxs("div",{style:{padding:"5px"},children:[s.jsx(j,{classes:this.state.classes,onChangeLevelsAtIndex:(r,e)=>{e.persist(),this.setState(l=>{let t=[...l.classes];return t[r]={levels:Number.parseInt(e.target.value),ranksPerLevel:t[r].ranksPerLevel},{classes:t}})},onChangeRanksPerLevelAtIndex:(r,e)=>{e.persist(),this.setState(l=>{let t=[...l.classes];return t[r]={levels:t[r].levels,ranksPerLevel:Number.parseInt(e.target.value)},{classes:t}})},onRemoveClassAtIndex:r=>{this.setState(e=>({classes:[...e.classes.slice(0,r),...e.classes.slice(r+1,e.classes.length)]}))},addClass:()=>{this.setState(r=>({classes:r.classes.concat({levels:1,ranksPerLevel:2})}))}}),s.jsxs("div",{style:{whiteSpace:"nowrap"},children:["Int Score: ",s.jsx("input",{style:c,type:"number",value:this.state.intScore,onChange:r=>{r.persist(),this.intScore=Number.parseInt(r.target.value)}}),"Int Mod: ",s.jsx("input",{style:c,type:"number",value:`${Math.floor((this.state.intScore-10)*.5)}`,onChange:r=>{const e=Number.parseInt(r.target.value);e!==Math.floor((this.state.intScore-10)*.5)&&(this.intScore=2*e+10)}})]}),s.jsxs("div",{style:{whiteSpace:"nowrap",textDecorationStyle:"dotted",textDecorationLine:"underline"},title:"Check this if the character gets bonus ranks through means besides leveling, e.g. from class features or feats",children:["Has Bonus ranks",s.jsx("input",{type:"checkbox",defaultChecked:this.state.skillGroups[0].type==1,onChange:()=>{this.state.skillGroups[0].type==1?this.setState(r=>({skillGroups:r.skillGroups.slice(1,r.skillGroups.length)})):this.setState(r=>({skillGroups:[{groupName:"Bonus",skills:[{skillName:"",ranksInGroup:0}],type:1},...r.skillGroups]}))}})]})]}),s.jsxs("div",{style:{display:"grid",width:"100%",gridTemplateColumns:"auto auto"},children:[s.jsxs("div",{children:[this.state.skillGroups.map((r,e)=>s.jsxs("div",{style:{padding:"5px"},children:[r.type==2?s.jsxs("span",{style:{padding:"5px",fontSize:"1em"},children:["Int Mod ",s.jsx(f,{used:this.state.skillGroups[e].skills.reduce((l,t)=>t.skillName.replace(/\s/g,"")!=""?l+t.ranksInGroup:l,0),total:this.intMod*(this.numberOfLevels+3)})]}):r.type==1?s.jsx("span",{children:r.groupName}):s.jsxs("div",{children:[s.jsx("input",{value:r.groupName,onChange:l=>{l.persist(),this.setState(t=>{let n=[...t.skillGroups];return n[e]={groupName:l.target.value,skills:t.skillGroups[e].skills,type:t.skillGroups[e].type},{skillGroups:n}})}}),s.jsx("span",{style:{padding:"5px"},children:s.jsx(f,{used:this.state.skillGroups[e].skills.reduce((l,t)=>t.skillName.replace(/\s/g,"")!=""?l+t.ranksInGroup:l,0),total:this.ranksPerGroup})})]}),s.jsx("div",{style:{whiteSpace:"nowrap",padding:"5px"},children:r.skills.map((l,t)=>s.jsxs("div",{children:[s.jsx("input",{value:l.skillName,onChange:n=>{n.persist(),this.setState(u=>{let i=[...u.skillGroups[e].skills];i[t]={skillName:n.target.value,ranksInGroup:0};let a=[...u.skillGroups];return a[e].skills=i,{skillGroups:a}})}}),(()=>{let n=this.state.skillGroups.reduce((u,i)=>u+i.skills.reduce((a,d)=>d.skillName==l.skillName?a+d.ranksInGroup:a,0),0);return s.jsx("span",{style:{paddingLeft:"5px",paddingRight:"5px",color:n<=this.numberOfLevels+3?"black":"red"},children:n})})(),s.jsx("input",{style:c,type:"number",min:"0",value:l.ranksInGroup,onChange:n=>{n.persist(),this.setState(u=>{let i=[...u.skillGroups[e].skills];i[t]={skillName:i[t].skillName,ranksInGroup:Number.parseInt(n.target.value)};let a=[...u.skillGroups];return a[e].skills=i,{skillGroups:a}})}}),s.jsx("span",{style:{cursor:"pointer"},onClick:()=>{this.setState(n=>{let u=[...n.skillGroups[e].skills];u[t]={skillName:u[t].skillName,ranksInGroup:this.numberOfLevels+3};let i=[...n.skillGroups];return i[e].skills=u,{skillGroups:i}})},children:"⏫"}),s.jsx("span",{style:{cursor:"pointer"},onClick:()=>{this.setState(n=>{let u=[...n.skillGroups[e].skills];u[t]={skillName:u[t].skillName,ranksInGroup:0};let i=[...n.skillGroups];return i[e].skills=u,{skillGroups:i}})},children:"⏬"}),s.jsx("button",{onClick:()=>{this.setState(n=>{let u=[...n.skillGroups],i=u[e].skills;return u[e].skills=[...i.slice(0,t),...i.slice(t+1,i.length)],{skillGroups:u}})},children:"-"})]},t))}),s.jsx("button",{onClick:()=>{this.setState(l=>{let t=[...l.skillGroups];return t[e].skills.push({skillName:"",ranksInGroup:0}),{skillGroups:t}})},children:"+"})]},e)),s.jsx("button",{onClick:()=>{this.setState(r=>({skillGroups:r.skillGroups.concat({groupName:"",skills:[{skillName:"",ranksInGroup:0}],type:0})}))},children:"+"})]}),s.jsx("div",{style:{padding:"10px",display:"grid",gridTemplateColumns:`repeat(${this.state.skillGroups.length+2}, auto)`},children:(()=>{let r=[...this.state.skillGroups.reduce((e,l)=>{for(let t of l.skills)t.skillName.replace(/\s/g,"")!=""&&e.add(t.skillName);return e},new Set)].sort((e,l)=>e.toLowerCase()<l.toLowerCase()?-1:e.toLowerCase()==l.toLowerCase()?0:1).map(e=>e);return[(()=>{let e=this.state.skillGroups.reduce((t,n)=>n.type!=1?t+n.skills.reduce((u,i)=>i.skillName.replace(/\s/g,"")!=""?u+i.ranksInGroup:u,0):t,0),l=this.ranksPerGroup*this.state.skillGroups.filter(t=>t.type==0).length+this.intMod*(3+this.numberOfLevels);return s.jsx("div",{style:{...g,display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center"},children:s.jsxs("div",{children:[s.jsx("div",{style:{color:e<l?"black":e>l?"red":"green"},children:"Group Total"}),s.jsx(f,{used:e,total:l})]})},"groupTotal")})(),s.jsx("div",{style:{...g,display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center"},children:s.jsx("div",{children:"Total"},"totalRanks")}),...this.state.skillGroups.map((e,l)=>s.jsx("div",{style:{...g,display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center"},children:(()=>{let t=0,n=0;switch(e.type){case 1:return s.jsx("div",{style:{...g,textAlign:"center"},children:s.jsx("div",{children:e.groupName})},l);case 2:t=this.state.skillGroups[l].skills.reduce((u,i)=>i.skillName.replace(/\s/g,"")!=""?u+i.ranksInGroup:u,0),n=this.intMod*(this.numberOfLevels+3);break;default:t=this.state.skillGroups[l].skills.reduce((u,i)=>i.skillName.replace(/\s/g,"")!=""?u+i.ranksInGroup:u,0),n=this.ranksPerGroup;break}return s.jsxs("div",{style:{...g,textAlign:"center"},children:[s.jsx("div",{style:{color:t>n?"red":t<n?"black":"green"},children:e.groupName}),s.jsx("div",{children:s.jsx(f,{used:t,total:n})})]},l)})()},l)),r.map((e,l)=>[s.jsx("div",{style:{width:"120px"},children:e},`${e}${l}`),(()=>{let t=this.state.skillGroups.reduce((n,u)=>n+u.skills.reduce((i,a)=>a.skillName==e?i+a.ranksInGroup:i,0),0);return s.jsx("div",{style:{fontSize:"1em",textAlign:"center",color:t<=this.numberOfLevels+3?"black":"red"},children:t},`${e}Total`)})(),...this.state.skillGroups.map((t,n)=>s.jsx("div",{style:{textAlign:"center"},children:(()=>{let u=!1;if(t.type!=0)u=!0;else for(let i of t.skills)if(i.skillName==e){u=!0;break}return u?s.jsxs("div",{style:{whiteSpace:"nowrap",paddingLeft:"5px",paddingRight:"5px"},children:[s.jsx("input",{style:c,type:"number",min:"0",disabled:(()=>{let i=!0;if(t.type!=0)return!1;for(let a of t.skills)if(a.skillName==e){i=!1;break}return i})(),value:this.state.skillGroups[n].skills.reduce((i,a)=>a.skillName==e?i+a.ranksInGroup:i,0),onChange:i=>{i.persist(),this.setState(a=>{let d=[...a.skillGroups[n].skills],p=!1,k=0;for(let v in d)if(d[v].skillName==e){p=!0,k=+v;break}p||(d.push({skillName:e,ranksInGroup:0}),k=d.length-1),d[k]={skillName:d[k].skillName,ranksInGroup:Number.parseInt(i.target.value)};let h=[...a.skillGroups];return h[n].skills=d,{skillGroups:h}})}},`${n}`),s.jsx("span",{style:{cursor:"pointer"},onClick:()=>{this.setState(i=>{let a=[...i.skillGroups[n].skills],d=!1,p=0;for(let h in a)if(a[h].skillName==e){d=!0,p=+h;break}d||(a.push({skillName:e,ranksInGroup:0}),p=a.length-1),a[p]={skillName:a[p].skillName,ranksInGroup:this.numberOfLevels+3};let k=[...i.skillGroups];return k[n].skills=a,{skillGroups:k}})},children:"⏫"}),s.jsx("span",{style:{cursor:"pointer"},onClick:()=>{this.setState(i=>{let a=[...i.skillGroups[n].skills],d=!1,p=0;for(let h in a)if(a[h].skillName==e){d=!0,p=+h;break}d||(a.push({skillName:e,ranksInGroup:0}),p=a.length-1),a[p]={skillName:a[p].skillName,ranksInGroup:0};let k=[...i.skillGroups];return k[n].skills=a,{skillGroups:k}})},children:"⏬"})]}):s.jsx("div",{})})()}))])]})()})]})]})}}export{C as A,x as G};
